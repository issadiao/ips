<?php
/**
 * Created by PhpStorm.
 * User: issa.diao
 * Date: 3/5/2014
 * Time: 10:08 AM
 */

include_once("ips_item_history_data.inc");

/*
function ips_item_history_entity_postupdate($entity, $entity_type) {

  watchdog("ENTITY", "type = $entity_type and entity = " . print_r($entity,TRUE));

}
*/

function ips_item_history_node_update($node) {

  //watchdog("NODE", "node = " . print_r($node,TRUE));

  $fields = array();
  $originals = array();
  $diff = array();

  foreach ($node as $key => $field) {
    if (substr(0,6) == "field_") {
      $fields[$key] = $field;
    }
  }

  foreach ($node->original as $key => $original) {
    if (substr(0,6) == "field_") {
      $originals[$key] = $original;
    }
  }

  $diff = array_merge(array_diff($fields, $originals), array_diff($originals, $fields));

  watchdog("DIFF", "diff = " . print_r($diff,TRUE));

}